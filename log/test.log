  [1m[35mSQL (0.1ms)[0m  [1m[35mSET search_path TO public[0m
  [1m[35m (88.6ms)[0m  [1m[35mDROP DATABASE IF EXISTS "nexus_test"[0m
  [1m[35m (46.6ms)[0m  [1m[35mCREATE DATABASE "nexus_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (27.4ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql" SCHEMA pg_catalog[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "packages" CASCADE[0m
  [1m[35m (2.7ms)[0m  [1m[35mCREATE TABLE "packages" ("id" bigserial primary key, "repository_id" bigint NOT NULL, "name" character varying NOT NULL, "group_id" character varying NOT NULL, "artifact_id" character varying NOT NULL, "last_modified" timestamp(6), "metadata" jsonb DEFAULT '{}', "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_packages_on_artifact_id" ON "packages" ("artifact_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_packages_on_group_id" ON "packages" ("group_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_packages_on_last_modified" ON "packages" ("last_modified")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_packages_on_repository_id_and_name" ON "packages" ("repository_id", "name")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_packages_on_repository_id" ON "packages" ("repository_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "repositories" CASCADE[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "repositories" ("id" bigserial primary key, "name" character varying NOT NULL, "url" character varying NOT NULL, "ecosystem" character varying DEFAULT 'maven', "last_indexed_at" timestamp(6), "status" character varying DEFAULT 'pending', "error_message" text, "package_count" integer DEFAULT 0, "index_size_bytes" bigint, "metadata" jsonb DEFAULT '{}', "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_repositories_on_last_indexed_at" ON "repositories" ("last_indexed_at")[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_repositories_on_name" ON "repositories" ("name")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE INDEX "index_repositories_on_status" ON "repositories" ("status")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "versions" CASCADE[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "versions" ("id" bigserial primary key, "package_id" bigint NOT NULL, "number" character varying NOT NULL, "last_modified" timestamp(6), "packaging" character varying, "metadata" jsonb DEFAULT '{}', "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_versions_on_last_modified" ON "versions" ("last_modified")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_versions_on_package_id_and_number" ON "versions" ("package_id", "number")[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE INDEX "index_versions_on_package_id" ON "versions" ("package_id")[0m
  [1m[35m (2.9ms)[0m  [1m[35mALTER TABLE "packages" ADD CONSTRAINT "fk_rails_6e38ac67c3"
FOREIGN KEY ("repository_id")
  REFERENCES "repositories" ("id")
[0m
  [1m[35m (0.5ms)[0m  [1m[35mALTER TABLE "versions" ADD CONSTRAINT "fk_rails_147d97cf36"
FOREIGN KEY ("package_id")
  REFERENCES "packages" ("id")
[0m
  [1m[35m (1.4ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Load (2.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.6ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20251031000003)[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20251031000002),
(20251031000001);[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.2ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-10-31 16:38:14.753994', '2025-10-31 16:38:14.753996') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('schema_sha1', '19cf99e9a959f2cc2604f4f7f8f7c7cd593935b1', '2025-10-31 16:38:14.764404', '2025-10-31 16:38:14.764405') RETURNING "key"[0m
  [1m[36mActiveRecord::SchemaMigration Load (2.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------------------------------
RepositoryTest: test_: validations should validate that :name is case-sensitively unique. 
------------------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mRepository Load (0.5ms)[0m  [1m[34mSELECT "repositories".* FROM "repositories" ORDER BY "repositories"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Create (0.7ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", nil], ["url", nil], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:38:14.904301"], ["updated_at", "2025-10-31 16:38:14.904301"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------------------------
RepositoryTest: test_: associations should have many packages dependent => destroy. 
------------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------------------
RepositoryTest: test_: status management should mark as completed. 
-------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "test-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.7ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "test-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:38:14.912630"], ["updated_at", "2025-10-31 16:38:14.912630"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Update (0.2ms)[0m  [1m[33mUPDATE "repositories" SET "last_indexed_at" = $1, "status" = $2, "package_count" = $3, "index_size_bytes" = $4, "updated_at" = $5 WHERE "repositories"."id" = $6[0m  [["last_indexed_at", "2025-10-31 16:38:14.913789"], ["status", "completed"], ["package_count", 100], ["index_size_bytes", 1000], ["updated_at", "2025-10-31 16:38:14.914984"], ["id", 2]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------------------------------------
RepositoryTest: test_: validations should validate that :name cannot be empty/falsy. 
-------------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mRepository Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", ""], ["LIMIT", 1]]
  [1m[36mRepository Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" IS NULL LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------------------
RepositoryTest: test_: #needs_reindex? should return false if recently indexed. 
--------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------
RepositoryTest: test_: scopes should return pending repositories. 
------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "pending-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.1ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "pending-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:38:14.929877"], ["updated_at", "2025-10-31 16:38:14.929877"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "indexing-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.1ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "indexing-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "indexing"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:38:14.932613"], ["updated_at", "2025-10-31 16:38:14.932613"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "completed-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.1ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "completed-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", "2025-10-31 15:38:14.935812"], ["status", "completed"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:38:14.938739"], ["updated_at", "2025-10-31 16:38:14.938739"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "failed-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.1ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "failed-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "failed"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:38:14.940488"], ["updated_at", "2025-10-31 16:38:14.940488"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."status" = $1 AND "repositories"."id" = $2 LIMIT $3[0m  [["status", "pending"], ["id", 3], ["LIMIT", 1]]
  [1m[36mRepository Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."status" = $1 AND "repositories"."id" = $2 LIMIT $3[0m  [["status", "pending"], ["id", 5], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------
RepositoryTest: test_: status management should mark as indexing. 
------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "test-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.1ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "test-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:38:14.947630"], ["updated_at", "2025-10-31 16:38:14.947630"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Update (0.2ms)[0m  [1m[33mUPDATE "repositories" SET "status" = $1, "updated_at" = $2 WHERE "repositories"."id" = $3[0m  [["status", "indexing"], ["updated_at", "2025-10-31 16:38:14.948395"], ["id", 7]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------------------------------------------
RepositoryTest: test_: #needs_reindex? should return true if last indexed beyond interval. 
-------------------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------
RepositoryTest: test_: #index_url should return the correct index URL. 
-----------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------------------------
RepositoryTest: test_: validations should validate that :url cannot be empty/falsy. 
------------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mRepository Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" IS NULL LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mCACHE Repository Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" IS NULL LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------
RepositoryTest: test_: scopes should return completed repositories. 
--------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "pending-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.3ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "pending-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:38:14.962300"], ["updated_at", "2025-10-31 16:38:14.962300"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "indexing-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.4ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "indexing-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "indexing"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:38:14.974943"], ["updated_at", "2025-10-31 16:38:14.974943"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "completed-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.3ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "completed-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", "2025-10-31 15:38:14.979781"], ["status", "completed"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:38:14.981023"], ["updated_at", "2025-10-31 16:38:14.981023"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "failed-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.4ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "failed-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "failed"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:38:14.990663"], ["updated_at", "2025-10-31 16:38:14.990663"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."status" = $1 AND "repositories"."id" = $2 LIMIT $3[0m  [["status", "completed"], ["id", 10], ["LIMIT", 1]]
  [1m[36mRepository Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."status" = $1 AND "repositories"."id" = $2 LIMIT $3[0m  [["status", "completed"], ["id", 8], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------
RepositoryTest: test_: status management should mark as failed. 
----------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (1.0ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "test-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.2ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "test-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:38:15.000949"], ["updated_at", "2025-10-31 16:38:15.000949"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Update (0.6ms)[0m  [1m[33mUPDATE "repositories" SET "status" = $1, "error_message" = $2, "updated_at" = $3 WHERE "repositories"."id" = $4[0m  [["status", "failed"], ["error_message", "Test error"], ["updated_at", "2025-10-31 16:38:15.001902"], ["id", 12]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------------
RepositoryTest: test_: #needs_reindex? should return true if never indexed. 
----------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------
MavenIndexParserTest: test_: #parse should parse .fld file correctly. 
----------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------------
PackageTest: test_: associations should belong to repository required: true. 
-----------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mPackage Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "packages" WHERE "packages"."name" IS NULL AND "packages"."repository_id" IS NULL LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------------------------
PackageTest: test_: validations should validate that :group_id cannot be empty/falsy. 
--------------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mPackage Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "packages" WHERE "packages"."name" IS NULL AND "packages"."repository_id" IS NULL LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mCACHE Package Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "packages" WHERE "packages"."name" IS NULL AND "packages"."repository_id" IS NULL LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------------------------
PackageTest: test_: associations should have many versions dependent => destroy. 
---------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------------------------
PackageTest: test_: validations should validate that :artifact_id cannot be empty/falsy. 
-----------------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mPackage Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "packages" WHERE "packages"."name" IS NULL AND "packages"."repository_id" IS NULL LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mCACHE Package Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "packages" WHERE "packages"."name" IS NULL AND "packages"."repository_id" IS NULL LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------------------
PackageTest: test_: validations should validate that :name cannot be empty/falsy. 
----------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mPackage Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "packages" WHERE "packages"."name" = $1 AND "packages"."repository_id" IS NULL LIMIT $2[0m  [["name", ""], ["LIMIT", 1]]
  [1m[36mPackage Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "packages" WHERE "packages"."name" IS NULL AND "packages"."repository_id" IS NULL LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------------------------------------------
PackageTest: test_: #set_name_from_parts should automatically set name from group_id and artifact_id. 
------------------------------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "test-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.4ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "test-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:38:15.053617"], ["updated_at", "2025-10-31 16:38:15.053617"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mPackage Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "packages" WHERE "packages"."name" = $1 AND "packages"."repository_id" = $2 LIMIT $3[0m  [["name", "org.example:test-lib"], ["repository_id", 13], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------
PackageTest: test_: scopes should return recently updated packages. 
--------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "test-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.3ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "test-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:38:15.059077"], ["updated_at", "2025-10-31 16:38:15.059077"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPackage Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "packages" WHERE "packages"."name" = $1 AND "packages"."repository_id" = $2 LIMIT $3[0m  [["name", "recent:package"], ["repository_id", 14], ["LIMIT", 1]]
  [1m[36mPackage Create (1.2ms)[0m  [1m[32mINSERT INTO "packages" ("repository_id", "name", "group_id", "artifact_id", "last_modified", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["repository_id", 14], ["name", "recent:package"], ["group_id", "recent"], ["artifact_id", "package"], ["last_modified", "2025-10-30 16:38:15.060372"], ["metadata", "{}"], ["created_at", "2025-10-31 16:38:15.064407"], ["updated_at", "2025-10-31 16:38:15.064407"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPackage Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "packages" WHERE "packages"."name" = $1 AND "packages"."repository_id" = $2 LIMIT $3[0m  [["name", "old:package"], ["repository_id", 14], ["LIMIT", 1]]
  [1m[36mPackage Create (0.3ms)[0m  [1m[32mINSERT INTO "packages" ("repository_id", "name", "group_id", "artifact_id", "last_modified", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["repository_id", 14], ["name", "old:package"], ["group_id", "old"], ["artifact_id", "package"], ["last_modified", "2025-10-17 16:38:15.068356"], ["metadata", "{}"], ["created_at", "2025-10-31 16:38:15.069070"], ["updated_at", "2025-10-31 16:38:15.069070"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mPackage Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "packages" WHERE (last_modified >= $1) AND "packages"."id" = $2 LIMIT $3[0m  [[nil, "2025-10-24 16:38:15.069606"], ["id", 1], ["LIMIT", 1]]
  [1m[36mPackage Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "packages" WHERE (last_modified >= $1) AND "packages"."id" = $2 LIMIT $3[0m  [[nil, "2025-10-24 16:38:15.070780"], ["id", 2], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------------------------------------------------
Api::V1::RepositoriesControllerTest: test_: GET /api/v1/repositories/:name/packages should return package names. 
-----------------------------------------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "test-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.2ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "test-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:38:15.073872"], ["updated_at", "2025-10-31 16:38:15.073872"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPackage Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "packages" WHERE "packages"."name" = $1 AND "packages"."repository_id" = $2 LIMIT $3[0m  [["name", "org.example:lib1"], ["repository_id", 15], ["LIMIT", 1]]
  [1m[36mPackage Create (0.2ms)[0m  [1m[32mINSERT INTO "packages" ("repository_id", "name", "group_id", "artifact_id", "last_modified", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["repository_id", 15], ["name", "org.example:lib1"], ["group_id", "org.example"], ["artifact_id", "lib1"], ["last_modified", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:38:15.074894"], ["updated_at", "2025-10-31 16:38:15.074894"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPackage Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "packages" WHERE "packages"."name" = $1 AND "packages"."repository_id" = $2 LIMIT $3[0m  [["name", "org.example:lib2"], ["repository_id", 15], ["LIMIT", 1]]
  [1m[36mPackage Create (0.2ms)[0m  [1m[32mINSERT INTO "packages" ("repository_id", "name", "group_id", "artifact_id", "last_modified", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["repository_id", 15], ["name", "org.example:lib2"], ["group_id", "org.example"], ["artifact_id", "lib2"], ["last_modified", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:38:15.076136"], ["updated_at", "2025-10-31 16:38:15.076136"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/api/v1/repositories/test-repo/packages" for 127.0.0.1 at 2025-10-31 16:38:15 +0000
Processing by Api::V1::RepositoriesController#packages as JSON
  Parameters: {"name" => "test-repo"}
  [1m[36mRepository Load (0.5ms)[0m  [1m[34mSELECT "repositories".* FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "test-repo"], ["LIMIT", 1]]
  [1m[36mPackage Pluck (0.5ms)[0m  [1m[34mSELECT "packages"."name" FROM "packages" WHERE "packages"."repository_id" = $1[0m  [["repository_id", 15]]
Completed 200 OK in 20ms (Views: 0.2ms | ActiveRecord: 1.0ms (2 queries, 0 cached) | GC: 1.1ms)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------------------------------------------------------------
Api::V1::RepositoriesControllerTest: test_: GET /api/v1/repositories/:name should return repository details. 
-------------------------------------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "test-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.3ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "test-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:38:15.156947"], ["updated_at", "2025-10-31 16:38:15.156947"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/api/v1/repositories/test-repo" for 127.0.0.1 at 2025-10-31 16:38:15 +0000
Processing by Api::V1::RepositoriesController#show as JSON
  Parameters: {"name" => "test-repo"}
  [1m[36mRepository Load (0.2ms)[0m  [1m[34mSELECT "repositories".* FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "test-repo"], ["LIMIT", 1]]
Completed 200 OK in 2ms (Views: 0.1ms | ActiveRecord: 0.2ms (1 query, 0 cached) | GC: 0.4ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------------------------------------
Api::V1::RepositoriesControllerTest: test_: GET /api/v1/repositories should return all repositories. 
-----------------------------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "repo1"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.3ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "repo1"], ["url", "http://example.com/repo1"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:38:15.164447"], ["updated_at", "2025-10-31 16:38:15.164447"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "repo2"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.2ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "repo2"], ["url", "http://example.com/repo2"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:38:15.165797"], ["updated_at", "2025-10-31 16:38:15.165797"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/api/v1/repositories" for 127.0.0.1 at 2025-10-31 16:38:15 +0000
Processing by Api::V1::RepositoriesController#index as JSON
  [1m[36mRepository Load (1.7ms)[0m  [1m[34mSELECT "repositories".* FROM "repositories" ORDER BY "repositories"."name" ASC[0m
Completed 200 OK in 3ms (Views: 0.1ms | ActiveRecord: 1.7ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------------------------------------------
Api::V1::RepositoriesControllerTest: test_: POST /api/v1/sync_repositories should create new repositories. 
-----------------------------------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
Started POST "/api/v1/sync_repositories" for 127.0.0.1 at 2025-10-31 16:38:15 +0000
Processing by Api::V1::RepositoriesController#sync as JSON
  Parameters: {"_json" => [{"name" => "new-repo", "url" => "http://example.com/new", "ecosystem" => "maven"}], "repository" => {}}
  [1m[36mRepository Load (0.2ms)[0m  [1m[34mSELECT "repositories".* FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "new-repo"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "new-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.2ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "new-repo"], ["url", "http://example.com/new"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:38:15.173738"], ["updated_at", "2025-10-31 16:38:15.173738"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 2ms (Views: 0.0ms | ActiveRecord: 0.7ms (3 queries, 0 cached) | GC: 0.0ms)
  [1m[36mRepository Load (0.2ms)[0m  [1m[34mSELECT "repositories".* FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "new-repo"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mActiveRecord::InternalMetadata Load (3.6ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (2.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------
MavenIndexParserTest: test_: #parse should parse .fld file correctly. 
----------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------------
PackageTest: test_: associations should belong to repository required: true. 
-----------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mPackage Exists? (1.5ms)[0m  [1m[34mSELECT 1 AS one FROM "packages" WHERE "packages"."name" IS NULL AND "packages"."repository_id" IS NULL LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------------------------
PackageTest: test_: validations should validate that :group_id cannot be empty/falsy. 
--------------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "test-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.3ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "test-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:38:53.356697"], ["updated_at", "2025-10-31 16:38:53.356697"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mPackage Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "packages" WHERE "packages"."name" IS NULL AND "packages"."repository_id" = $1 LIMIT $2[0m  [["repository_id", 20], ["LIMIT", 1]]
  [1m[36mCACHE Package Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "packages" WHERE "packages"."name" IS NULL AND "packages"."repository_id" = $1 LIMIT $2[0m  [["repository_id", 20], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------------------
PackageTest: test_: validations should validate that :name cannot be empty/falsy. 
----------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "test-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.3ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "test-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:38:53.362601"], ["updated_at", "2025-10-31 16:38:53.362601"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mPackage Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "packages" WHERE "packages"."name" = $1 AND "packages"."repository_id" = $2 LIMIT $3[0m  [["name", "org.example:test"], ["repository_id", 21], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------------------------------------------
PackageTest: test_: #set_name_from_parts should automatically set name from group_id and artifact_id. 
------------------------------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "test-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.3ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "test-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:38:53.369294"], ["updated_at", "2025-10-31 16:38:53.369294"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mPackage Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "packages" WHERE "packages"."name" = $1 AND "packages"."repository_id" = $2 LIMIT $3[0m  [["name", "org.example:test-lib"], ["repository_id", 22], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------------------------
PackageTest: test_: associations should have many versions dependent => destroy. 
---------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------
PackageTest: test_: scopes should return recently updated packages. 
--------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "test-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.2ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "test-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:38:53.383048"], ["updated_at", "2025-10-31 16:38:53.383048"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPackage Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "packages" WHERE "packages"."name" = $1 AND "packages"."repository_id" = $2 LIMIT $3[0m  [["name", "recent:package"], ["repository_id", 23], ["LIMIT", 1]]
  [1m[36mPackage Create (1.0ms)[0m  [1m[32mINSERT INTO "packages" ("repository_id", "name", "group_id", "artifact_id", "last_modified", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["repository_id", 23], ["name", "recent:package"], ["group_id", "recent"], ["artifact_id", "package"], ["last_modified", "2025-10-30 16:38:53.383950"], ["metadata", "{}"], ["created_at", "2025-10-31 16:38:53.384768"], ["updated_at", "2025-10-31 16:38:53.384768"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPackage Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "packages" WHERE "packages"."name" = $1 AND "packages"."repository_id" = $2 LIMIT $3[0m  [["name", "old:package"], ["repository_id", 23], ["LIMIT", 1]]
  [1m[36mPackage Create (0.4ms)[0m  [1m[32mINSERT INTO "packages" ("repository_id", "name", "group_id", "artifact_id", "last_modified", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["repository_id", 23], ["name", "old:package"], ["group_id", "old"], ["artifact_id", "package"], ["last_modified", "2025-10-17 16:38:53.387082"], ["metadata", "{}"], ["created_at", "2025-10-31 16:38:53.388928"], ["updated_at", "2025-10-31 16:38:53.388928"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mPackage Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "packages" WHERE (last_modified >= $1) AND "packages"."id" = $2 LIMIT $3[0m  [[nil, "2025-10-24 16:38:53.392608"], ["id", 5], ["LIMIT", 1]]
  [1m[36mPackage Exists? (1.8ms)[0m  [1m[34mSELECT 1 AS one FROM "packages" WHERE (last_modified >= $1) AND "packages"."id" = $2 LIMIT $3[0m  [[nil, "2025-10-24 16:38:53.393681"], ["id", 6], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------------------------
PackageTest: test_: validations should validate that :artifact_id cannot be empty/falsy. 
-----------------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "test-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.2ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "test-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:38:53.397272"], ["updated_at", "2025-10-31 16:38:53.397272"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mPackage Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "packages" WHERE "packages"."name" IS NULL AND "packages"."repository_id" = $1 LIMIT $2[0m  [["repository_id", 24], ["LIMIT", 1]]
  [1m[36mCACHE Package Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "packages" WHERE "packages"."name" IS NULL AND "packages"."repository_id" = $1 LIMIT $2[0m  [["repository_id", 24], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------------------------------------------------------------
Api::V1::RepositoriesControllerTest: test_: GET /api/v1/repositories/:name should return repository details. 
-------------------------------------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "test-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.5ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "test-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:38:53.412671"], ["updated_at", "2025-10-31 16:38:53.412671"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/api/v1/repositories/test-repo" for 127.0.0.1 at 2025-10-31 16:38:53 +0000
Processing by Api::V1::RepositoriesController#show as JSON
  Parameters: {"name" => "test-repo"}
  [1m[36mRepository Load (0.7ms)[0m  [1m[34mSELECT "repositories".* FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "test-repo"], ["LIMIT", 1]]
Completed 200 OK in 7ms (Views: 0.1ms | ActiveRecord: 0.9ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------------------------------------------
Api::V1::RepositoriesControllerTest: test_: POST /api/v1/sync_repositories should create new repositories. 
-----------------------------------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
Started POST "/api/v1/sync_repositories" for 127.0.0.1 at 2025-10-31 16:38:53 +0000
Processing by Api::V1::RepositoriesController#sync as JSON
  Parameters: {"_json" => [{"name" => "new-repo", "url" => "http://example.com/new", "ecosystem" => "maven"}], "repository" => {}}
  [1m[36mRepository Load (0.3ms)[0m  [1m[34mSELECT "repositories".* FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "new-repo"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "new-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.4ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "new-repo"], ["url", "http://example.com/new"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:38:53.482404"], ["updated_at", "2025-10-31 16:38:53.482404"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 0.1ms | ActiveRecord: 1.3ms (3 queries, 0 cached) | GC: 0.0ms)
  [1m[36mRepository Load (0.2ms)[0m  [1m[34mSELECT "repositories".* FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "new-repo"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------------------------------------------------
Api::V1::RepositoriesControllerTest: test_: GET /api/v1/repositories/:name/packages should return package names. 
-----------------------------------------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "test-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.3ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "test-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:38:53.497777"], ["updated_at", "2025-10-31 16:38:53.497777"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPackage Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "packages" WHERE "packages"."name" = $1 AND "packages"."repository_id" = $2 LIMIT $3[0m  [["name", "org.example:lib1"], ["repository_id", 27], ["LIMIT", 1]]
  [1m[36mPackage Create (0.4ms)[0m  [1m[32mINSERT INTO "packages" ("repository_id", "name", "group_id", "artifact_id", "last_modified", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["repository_id", 27], ["name", "org.example:lib1"], ["group_id", "org.example"], ["artifact_id", "lib1"], ["last_modified", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:38:53.502241"], ["updated_at", "2025-10-31 16:38:53.502241"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPackage Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "packages" WHERE "packages"."name" = $1 AND "packages"."repository_id" = $2 LIMIT $3[0m  [["name", "org.example:lib2"], ["repository_id", 27], ["LIMIT", 1]]
  [1m[36mPackage Create (0.4ms)[0m  [1m[32mINSERT INTO "packages" ("repository_id", "name", "group_id", "artifact_id", "last_modified", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["repository_id", 27], ["name", "org.example:lib2"], ["group_id", "org.example"], ["artifact_id", "lib2"], ["last_modified", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:38:53.505928"], ["updated_at", "2025-10-31 16:38:53.505928"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/api/v1/repositories/test-repo/packages" for 127.0.0.1 at 2025-10-31 16:38:53 +0000
Processing by Api::V1::RepositoriesController#packages as JSON
  Parameters: {"name" => "test-repo"}
  [1m[36mRepository Load (0.3ms)[0m  [1m[34mSELECT "repositories".* FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "test-repo"], ["LIMIT", 1]]
  [1m[36mPackage Pluck (0.6ms)[0m  [1m[34mSELECT "packages"."name" FROM "packages" WHERE "packages"."repository_id" = $1[0m  [["repository_id", 27]]
Completed 200 OK in 11ms (Views: 0.1ms | ActiveRecord: 0.9ms (2 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------------------------------------
Api::V1::RepositoriesControllerTest: test_: GET /api/v1/repositories should return all repositories. 
-----------------------------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "repo1"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.3ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "repo1"], ["url", "http://example.com/repo1"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:38:53.522861"], ["updated_at", "2025-10-31 16:38:53.522861"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (1.1ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "repo2"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.3ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "repo2"], ["url", "http://example.com/repo2"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:38:53.525975"], ["updated_at", "2025-10-31 16:38:53.525975"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/api/v1/repositories" for 127.0.0.1 at 2025-10-31 16:38:53 +0000
Processing by Api::V1::RepositoriesController#index as JSON
  [1m[36mRepository Load (2.1ms)[0m  [1m[34mSELECT "repositories".* FROM "repositories" ORDER BY "repositories"."name" ASC[0m
Completed 200 OK in 5ms (Views: 0.0ms | ActiveRecord: 2.1ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------
RepositoryTest: test_: scopes should return pending repositories. 
------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "pending-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.2ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "pending-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:38:53.541274"], ["updated_at", "2025-10-31 16:38:53.541274"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "indexing-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.2ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "indexing-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "indexing"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:38:53.542574"], ["updated_at", "2025-10-31 16:38:53.542574"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "completed-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.2ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "completed-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", "2025-10-31 15:38:53.542967"], ["status", "completed"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:38:53.543598"], ["updated_at", "2025-10-31 16:38:53.543598"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "failed-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.2ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "failed-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "failed"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:38:53.545830"], ["updated_at", "2025-10-31 16:38:53.545830"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."status" = $1 AND "repositories"."id" = $2 LIMIT $3[0m  [["status", "pending"], ["id", 30], ["LIMIT", 1]]
  [1m[36mRepository Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."status" = $1 AND "repositories"."id" = $2 LIMIT $3[0m  [["status", "pending"], ["id", 32], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------------------------
RepositoryTest: test_: associations should have many packages dependent => destroy. 
------------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------------------------------
RepositoryTest: test_: validations should validate that :name is case-sensitively unique. 
------------------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mRepository Load (0.5ms)[0m  [1m[34mSELECT "repositories".* FROM "repositories" ORDER BY "repositories"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Create (0.8ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "test-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:38:53.551476"], ["updated_at", "2025-10-31 16:38:53.551476"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "test-repo"], ["LIMIT", 1]]
  [1m[36mRepository Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "TEST-REPO"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------------------
RepositoryTest: test_: #needs_reindex? should return false if recently indexed. 
--------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------
RepositoryTest: test_: #index_url should return the correct index URL. 
-----------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------------
RepositoryTest: test_: #needs_reindex? should return true if never indexed. 
----------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------
RepositoryTest: test_: scopes should return completed repositories. 
--------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "pending-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.7ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "pending-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:38:53.578627"], ["updated_at", "2025-10-31 16:38:53.578627"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (1.0ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "indexing-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.4ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "indexing-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "indexing"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:38:53.581019"], ["updated_at", "2025-10-31 16:38:53.581019"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "completed-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.2ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "completed-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", "2025-10-31 15:38:53.581883"], ["status", "completed"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:38:53.583124"], ["updated_at", "2025-10-31 16:38:53.583124"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "failed-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.4ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "failed-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "failed"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:38:53.585150"], ["updated_at", "2025-10-31 16:38:53.585150"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."status" = $1 AND "repositories"."id" = $2 LIMIT $3[0m  [["status", "completed"], ["id", 37], ["LIMIT", 1]]
  [1m[36mRepository Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."status" = $1 AND "repositories"."id" = $2 LIMIT $3[0m  [["status", "completed"], ["id", 35], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------------------------------------
RepositoryTest: test_: validations should validate that :name cannot be empty/falsy. 
-------------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mRepository Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", ""], ["LIMIT", 1]]
  [1m[36mRepository Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" IS NULL LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------
RepositoryTest: test_: status management should mark as indexing. 
------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "test-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.3ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "test-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:38:53.593992"], ["updated_at", "2025-10-31 16:38:53.593992"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Update (0.5ms)[0m  [1m[33mUPDATE "repositories" SET "status" = $1, "updated_at" = $2 WHERE "repositories"."id" = $3[0m  [["status", "indexing"], ["updated_at", "2025-10-31 16:38:53.600837"], ["id", 39]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------
RepositoryTest: test_: status management should mark as failed. 
----------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "test-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.2ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "test-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:38:53.614325"], ["updated_at", "2025-10-31 16:38:53.614325"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Update (0.3ms)[0m  [1m[33mUPDATE "repositories" SET "status" = $1, "error_message" = $2, "updated_at" = $3 WHERE "repositories"."id" = $4[0m  [["status", "failed"], ["error_message", "Test error"], ["updated_at", "2025-10-31 16:38:53.615838"], ["id", 40]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------------------------------------------
RepositoryTest: test_: #needs_reindex? should return true if last indexed beyond interval. 
-------------------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------------------
RepositoryTest: test_: status management should mark as completed. 
-------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "test-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.2ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "test-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:38:53.622099"], ["updated_at", "2025-10-31 16:38:53.622099"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Update (0.3ms)[0m  [1m[33mUPDATE "repositories" SET "last_indexed_at" = $1, "status" = $2, "package_count" = $3, "index_size_bytes" = $4, "updated_at" = $5 WHERE "repositories"."id" = $6[0m  [["last_indexed_at", "2025-10-31 16:38:53.622596"], ["status", "completed"], ["package_count", 100], ["index_size_bytes", 1000], ["updated_at", "2025-10-31 16:38:53.622672"], ["id", 41]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------------------------
RepositoryTest: test_: validations should validate that :url cannot be empty/falsy. 
------------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mRepository Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "test-repo"], ["LIMIT", 1]]
  [1m[36mCACHE Repository Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "test-repo"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mActiveRecord::InternalMetadata Load (3.7ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (2.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------------------------
RepositoryTest: test_: validations should validate that :url cannot be empty/falsy. 
------------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mRepository Exists? (1.0ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "test-repo"], ["LIMIT", 1]]
  [1m[36mCACHE Repository Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "test-repo"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------------------------------------
RepositoryTest: test_: validations should validate that :name cannot be empty/falsy. 
-------------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mRepository Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", ""], ["LIMIT", 1]]
  [1m[36mRepository Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" IS NULL LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------
RepositoryTest: test_: status management should mark as failed. 
----------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "test-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.4ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "test-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:39:08.220820"], ["updated_at", "2025-10-31 16:39:08.220820"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Update (0.4ms)[0m  [1m[33mUPDATE "repositories" SET "status" = $1, "error_message" = $2, "updated_at" = $3 WHERE "repositories"."id" = $4[0m  [["status", "failed"], ["error_message", "Test error"], ["updated_at", "2025-10-31 16:39:08.225469"], ["id", 42]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------------------
RepositoryTest: test_: #needs_reindex? should return false if recently indexed. 
--------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------
RepositoryTest: test_: #index_url should return the correct index URL. 
-----------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------
RepositoryTest: test_: scopes should return completed repositories. 
--------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "pending-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.2ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "pending-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:39:08.230894"], ["updated_at", "2025-10-31 16:39:08.230894"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "indexing-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.3ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "indexing-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "indexing"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:39:08.233859"], ["updated_at", "2025-10-31 16:39:08.233859"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "completed-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.2ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "completed-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", "2025-10-31 15:39:08.237043"], ["status", "completed"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:39:08.240668"], ["updated_at", "2025-10-31 16:39:08.240668"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "failed-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.2ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "failed-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "failed"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:39:08.242505"], ["updated_at", "2025-10-31 16:39:08.242505"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."status" = $1 AND "repositories"."id" = $2 LIMIT $3[0m  [["status", "completed"], ["id", 45], ["LIMIT", 1]]
  [1m[36mRepository Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."status" = $1 AND "repositories"."id" = $2 LIMIT $3[0m  [["status", "completed"], ["id", 43], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------------------------------
RepositoryTest: test_: validations should validate that :name is case-sensitively unique. 
------------------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mRepository Load (0.6ms)[0m  [1m[34mSELECT "repositories".* FROM "repositories" ORDER BY "repositories"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (1.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Create (1.8ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "test-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:39:08.248482"], ["updated_at", "2025-10-31 16:39:08.248482"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "test-repo"], ["LIMIT", 1]]
  [1m[36mRepository Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "TEST-REPO"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------------
RepositoryTest: test_: #needs_reindex? should return true if never indexed. 
----------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------------------------
RepositoryTest: test_: associations should have many packages dependent => destroy. 
------------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------
RepositoryTest: test_: scopes should return pending repositories. 
------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "pending-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.4ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "pending-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:39:08.275485"], ["updated_at", "2025-10-31 16:39:08.275485"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "indexing-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.4ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "indexing-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "indexing"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:39:08.283568"], ["updated_at", "2025-10-31 16:39:08.283568"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "completed-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.3ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "completed-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", "2025-10-31 15:39:08.288654"], ["status", "completed"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:39:08.289466"], ["updated_at", "2025-10-31 16:39:08.289466"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "failed-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.4ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "failed-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "failed"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:39:08.292261"], ["updated_at", "2025-10-31 16:39:08.292261"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."status" = $1 AND "repositories"."id" = $2 LIMIT $3[0m  [["status", "pending"], ["id", 48], ["LIMIT", 1]]
  [1m[36mRepository Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."status" = $1 AND "repositories"."id" = $2 LIMIT $3[0m  [["status", "pending"], ["id", 50], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------------------
RepositoryTest: test_: status management should mark as completed. 
-------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (1.8ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "test-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.3ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "test-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:39:08.307735"], ["updated_at", "2025-10-31 16:39:08.307735"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Update (0.6ms)[0m  [1m[33mUPDATE "repositories" SET "last_indexed_at" = $1, "status" = $2, "package_count" = $3, "index_size_bytes" = $4, "updated_at" = $5 WHERE "repositories"."id" = $6[0m  [["last_indexed_at", "2025-10-31 16:39:08.309741"], ["status", "completed"], ["package_count", 100], ["index_size_bytes", 1000], ["updated_at", "2025-10-31 16:39:08.309906"], ["id", 52]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------
RepositoryTest: test_: status management should mark as indexing. 
------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "test-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.4ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "test-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:39:08.318812"], ["updated_at", "2025-10-31 16:39:08.318812"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Update (0.8ms)[0m  [1m[33mUPDATE "repositories" SET "status" = $1, "updated_at" = $2 WHERE "repositories"."id" = $3[0m  [["status", "indexing"], ["updated_at", "2025-10-31 16:39:08.320732"], ["id", 53]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------------------------------------------
RepositoryTest: test_: #needs_reindex? should return true if last indexed beyond interval. 
-------------------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------
MavenIndexParserTest: test_: #parse should parse .fld file correctly. 
----------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------------------------------------
Api::V1::RepositoriesControllerTest: test_: GET /api/v1/repositories should return all repositories. 
-----------------------------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "repo1"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.3ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "repo1"], ["url", "http://example.com/repo1"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:39:08.331157"], ["updated_at", "2025-10-31 16:39:08.331157"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "repo2"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.3ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "repo2"], ["url", "http://example.com/repo2"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:39:08.333359"], ["updated_at", "2025-10-31 16:39:08.333359"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/api/v1/repositories" for 127.0.0.1 at 2025-10-31 16:39:08 +0000
Processing by Api::V1::RepositoriesController#index as JSON
  [1m[36mRepository Load (1.3ms)[0m  [1m[34mSELECT "repositories".* FROM "repositories" ORDER BY "repositories"."name" ASC[0m
Completed 200 OK in 13ms (Views: 0.1ms | ActiveRecord: 1.3ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------------------------------------------
Api::V1::RepositoriesControllerTest: test_: POST /api/v1/sync_repositories should create new repositories. 
-----------------------------------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
Started POST "/api/v1/sync_repositories" for 127.0.0.1 at 2025-10-31 16:39:08 +0000
Processing by Api::V1::RepositoriesController#sync as JSON
  Parameters: {"_json" => [{"name" => "new-repo", "url" => "http://example.com/new", "ecosystem" => "maven"}], "repository" => {}}
  [1m[36mRepository Load (0.4ms)[0m  [1m[34mSELECT "repositories".* FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "new-repo"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "new-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.4ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "new-repo"], ["url", "http://example.com/new"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:39:08.399918"], ["updated_at", "2025-10-31 16:39:08.399918"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.0ms | ActiveRecord: 1.3ms (3 queries, 0 cached) | GC: 0.0ms)
  [1m[36mRepository Load (0.3ms)[0m  [1m[34mSELECT "repositories".* FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "new-repo"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------------------------------------------------------------
Api::V1::RepositoriesControllerTest: test_: GET /api/v1/repositories/:name should return repository details. 
-------------------------------------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "test-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.3ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "test-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:39:08.406570"], ["updated_at", "2025-10-31 16:39:08.406570"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/api/v1/repositories/test-repo" for 127.0.0.1 at 2025-10-31 16:39:08 +0000
Processing by Api::V1::RepositoriesController#show as JSON
  Parameters: {"name" => "test-repo"}
  [1m[36mRepository Load (0.2ms)[0m  [1m[34mSELECT "repositories".* FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "test-repo"], ["LIMIT", 1]]
Completed 200 OK in 1ms (Views: 0.0ms | ActiveRecord: 0.2ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------------------------------------------------
Api::V1::RepositoriesControllerTest: test_: GET /api/v1/repositories/:name/packages should return package names. 
-----------------------------------------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "test-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.2ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "test-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:39:08.410077"], ["updated_at", "2025-10-31 16:39:08.410077"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPackage Exists? (1.1ms)[0m  [1m[34mSELECT 1 AS one FROM "packages" WHERE "packages"."name" = $1 AND "packages"."repository_id" = $2 LIMIT $3[0m  [["name", "org.example:lib1"], ["repository_id", 58], ["LIMIT", 1]]
  [1m[36mPackage Create (0.5ms)[0m  [1m[32mINSERT INTO "packages" ("repository_id", "name", "group_id", "artifact_id", "last_modified", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["repository_id", 58], ["name", "org.example:lib1"], ["group_id", "org.example"], ["artifact_id", "lib1"], ["last_modified", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:39:08.424577"], ["updated_at", "2025-10-31 16:39:08.424577"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPackage Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "packages" WHERE "packages"."name" = $1 AND "packages"."repository_id" = $2 LIMIT $3[0m  [["name", "org.example:lib2"], ["repository_id", 58], ["LIMIT", 1]]
  [1m[36mPackage Create (0.3ms)[0m  [1m[32mINSERT INTO "packages" ("repository_id", "name", "group_id", "artifact_id", "last_modified", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["repository_id", 58], ["name", "org.example:lib2"], ["group_id", "org.example"], ["artifact_id", "lib2"], ["last_modified", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:39:08.427867"], ["updated_at", "2025-10-31 16:39:08.427867"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/api/v1/repositories/test-repo/packages" for 127.0.0.1 at 2025-10-31 16:39:08 +0000
Processing by Api::V1::RepositoriesController#packages as JSON
  Parameters: {"name" => "test-repo"}
  [1m[36mRepository Load (0.2ms)[0m  [1m[34mSELECT "repositories".* FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "test-repo"], ["LIMIT", 1]]
  [1m[36mPackage Pluck (0.5ms)[0m  [1m[34mSELECT "packages"."name" FROM "packages" WHERE "packages"."repository_id" = $1[0m  [["repository_id", 58]]
Completed 200 OK in 7ms (Views: 0.0ms | ActiveRecord: 0.7ms (2 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------------------------------------------
PackageTest: test_: #set_name_from_parts should automatically set name from group_id and artifact_id. 
------------------------------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "test-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.4ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "test-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:39:08.438073"], ["updated_at", "2025-10-31 16:39:08.438073"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mPackage Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "packages" WHERE "packages"."name" = $1 AND "packages"."repository_id" = $2 LIMIT $3[0m  [["name", "org.example:test-lib"], ["repository_id", 59], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------------------------
PackageTest: test_: validations should validate that :artifact_id cannot be empty/falsy. 
-----------------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "test-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.3ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "test-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:39:08.443676"], ["updated_at", "2025-10-31 16:39:08.443676"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mPackage Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "packages" WHERE "packages"."name" = $1 AND "packages"."repository_id" = $2 LIMIT $3[0m  [["name", "test:package"], ["repository_id", 60], ["LIMIT", 1]]
  [1m[36mCACHE Package Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "packages" WHERE "packages"."name" = $1 AND "packages"."repository_id" = $2 LIMIT $3[0m  [["name", "test:package"], ["repository_id", 60], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------------------------
PackageTest: test_: validations should validate that :group_id cannot be empty/falsy. 
--------------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "test-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.4ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "test-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:39:08.454413"], ["updated_at", "2025-10-31 16:39:08.454413"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mPackage Exists? (3.9ms)[0m  [1m[34mSELECT 1 AS one FROM "packages" WHERE "packages"."name" = $1 AND "packages"."repository_id" = $2 LIMIT $3[0m  [["name", "test:package"], ["repository_id", 61], ["LIMIT", 1]]
  [1m[36mCACHE Package Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "packages" WHERE "packages"."name" = $1 AND "packages"."repository_id" = $2 LIMIT $3[0m  [["name", "test:package"], ["repository_id", 61], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------
PackageTest: test_: scopes should return recently updated packages. 
--------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "test-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.2ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "test-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 16:39:08.462761"], ["updated_at", "2025-10-31 16:39:08.462761"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPackage Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "packages" WHERE "packages"."name" = $1 AND "packages"."repository_id" = $2 LIMIT $3[0m  [["name", "recent:package"], ["repository_id", 62], ["LIMIT", 1]]
  [1m[36mPackage Create (0.2ms)[0m  [1m[32mINSERT INTO "packages" ("repository_id", "name", "group_id", "artifact_id", "last_modified", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["repository_id", 62], ["name", "recent:package"], ["group_id", "recent"], ["artifact_id", "package"], ["last_modified", "2025-10-30 16:39:08.463632"], ["metadata", "{}"], ["created_at", "2025-10-31 16:39:08.464447"], ["updated_at", "2025-10-31 16:39:08.464447"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPackage Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "packages" WHERE "packages"."name" = $1 AND "packages"."repository_id" = $2 LIMIT $3[0m  [["name", "old:package"], ["repository_id", 62], ["LIMIT", 1]]
  [1m[36mPackage Create (0.3ms)[0m  [1m[32mINSERT INTO "packages" ("repository_id", "name", "group_id", "artifact_id", "last_modified", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["repository_id", 62], ["name", "old:package"], ["group_id", "old"], ["artifact_id", "package"], ["last_modified", "2025-10-17 16:39:08.465291"], ["metadata", "{}"], ["created_at", "2025-10-31 16:39:08.465741"], ["updated_at", "2025-10-31 16:39:08.465741"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mPackage Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "packages" WHERE (last_modified >= $1) AND "packages"."id" = $2 LIMIT $3[0m  [[nil, "2025-10-24 16:39:08.466199"], ["id", 11], ["LIMIT", 1]]
  [1m[36mPackage Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "packages" WHERE (last_modified >= $1) AND "packages"."id" = $2 LIMIT $3[0m  [[nil, "2025-10-24 16:39:08.470022"], ["id", 12], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------------
PackageTest: test_: associations should belong to repository required: true. 
-----------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mPackage Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "packages" WHERE "packages"."name" IS NULL AND "packages"."repository_id" IS NULL LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------------------------
PackageTest: test_: associations should have many versions dependent => destroy. 
---------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mActiveRecord::InternalMetadata Load (3.7ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (2.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------------------------
RepositoryTest: test_: associations should have many packages dependent => destroy. 
------------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------------------------------------
RepositoryTest: test_: validations should validate that :name cannot be empty/falsy. 
-------------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mRepository Exists? (1.6ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", ""], ["LIMIT", 1]]
  [1m[36mRepository Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" IS NULL LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------------------
RepositoryTest: test_: status management should mark as completed. 
-------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "test-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (1.3ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "test-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 17:01:06.905524"], ["updated_at", "2025-10-31 17:01:06.905524"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Update (1.3ms)[0m  [1m[33mUPDATE "repositories" SET "last_indexed_at" = $1, "status" = $2, "package_count" = $3, "index_size_bytes" = $4, "updated_at" = $5 WHERE "repositories"."id" = $6[0m  [["last_indexed_at", "2025-10-31 17:01:06.907538"], ["status", "completed"], ["package_count", 100], ["index_size_bytes", 1000], ["updated_at", "2025-10-31 17:01:06.911708"], ["id", 63]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------
RepositoryTest: test_: status management should mark as failed. 
----------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "test-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.3ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "test-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 17:01:06.915895"], ["updated_at", "2025-10-31 17:01:06.915895"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Update (0.3ms)[0m  [1m[33mUPDATE "repositories" SET "status" = $1, "error_message" = $2, "updated_at" = $3 WHERE "repositories"."id" = $4[0m  [["status", "failed"], ["error_message", "Test error"], ["updated_at", "2025-10-31 17:01:06.918090"], ["id", 64]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------
RepositoryTest: test_: status management should mark as indexing. 
------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "test-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.3ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "test-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 17:01:06.922357"], ["updated_at", "2025-10-31 17:01:06.922357"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Update (0.8ms)[0m  [1m[33mUPDATE "repositories" SET "status" = $1, "updated_at" = $2 WHERE "repositories"."id" = $3[0m  [["status", "indexing"], ["updated_at", "2025-10-31 17:01:06.926082"], ["id", 65]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------------
RepositoryTest: test_: #needs_reindex? should return true if never indexed. 
----------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------------------
RepositoryTest: test_: #needs_reindex? should return false if recently indexed. 
--------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------------------------------------------
RepositoryTest: test_: #needs_reindex? should return true if last indexed beyond interval. 
-------------------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------
RepositoryTest: test_: scopes should return pending repositories. 
------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "pending-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.3ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "pending-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 17:01:06.935836"], ["updated_at", "2025-10-31 17:01:06.935836"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "indexing-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.5ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "indexing-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "indexing"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 17:01:06.939853"], ["updated_at", "2025-10-31 17:01:06.939853"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "completed-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.2ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "completed-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", "2025-10-31 16:01:06.950281"], ["status", "completed"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 17:01:06.950900"], ["updated_at", "2025-10-31 17:01:06.950900"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "failed-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.4ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "failed-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "failed"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 17:01:06.952092"], ["updated_at", "2025-10-31 17:01:06.952092"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."status" = $1 AND "repositories"."id" = $2 LIMIT $3[0m  [["status", "pending"], ["id", 66], ["LIMIT", 1]]
  [1m[36mRepository Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."status" = $1 AND "repositories"."id" = $2 LIMIT $3[0m  [["status", "pending"], ["id", 68], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------------------------------
RepositoryTest: test_: validations should validate that :name is case-sensitively unique. 
------------------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mRepository Load (0.6ms)[0m  [1m[34mSELECT "repositories".* FROM "repositories" ORDER BY "repositories"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (1.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Create (1.9ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "test-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 17:01:06.958688"], ["updated_at", "2025-10-31 17:01:06.958688"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "test-repo"], ["LIMIT", 1]]
  [1m[36mRepository Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "TEST-REPO"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (2.2ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------
RepositoryTest: test_: scopes should return completed repositories. 
--------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "pending-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.4ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "pending-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 17:01:06.978893"], ["updated_at", "2025-10-31 17:01:06.978893"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "indexing-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.3ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "indexing-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "indexing"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 17:01:06.982792"], ["updated_at", "2025-10-31 17:01:06.982792"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "completed-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.4ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "completed-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", "2025-10-31 16:01:06.984470"], ["status", "completed"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 17:01:06.991422"], ["updated_at", "2025-10-31 17:01:06.991422"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "failed-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.2ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "failed-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "failed"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 17:01:06.994484"], ["updated_at", "2025-10-31 17:01:06.994484"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."status" = $1 AND "repositories"."id" = $2 LIMIT $3[0m  [["status", "completed"], ["id", 73], ["LIMIT", 1]]
  [1m[36mRepository Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."status" = $1 AND "repositories"."id" = $2 LIMIT $3[0m  [["status", "completed"], ["id", 71], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------------------------
RepositoryTest: test_: validations should validate that :url cannot be empty/falsy. 
------------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mRepository Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "test-repo"], ["LIMIT", 1]]
  [1m[36mCACHE Repository Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "test-repo"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------
RepositoryTest: test_: #index_url should return the correct index URL. 
-----------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------------------------
PackageTest: test_: validations should validate that :artifact_id cannot be empty/falsy. 
-----------------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "test-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.4ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "test-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 17:01:07.013785"], ["updated_at", "2025-10-31 17:01:07.013785"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mPackage Exists? (3.0ms)[0m  [1m[34mSELECT 1 AS one FROM "packages" WHERE "packages"."name" = $1 AND "packages"."repository_id" = $2 LIMIT $3[0m  [["name", "test:package"], ["repository_id", 75], ["LIMIT", 1]]
  [1m[36mCACHE Package Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "packages" WHERE "packages"."name" = $1 AND "packages"."repository_id" = $2 LIMIT $3[0m  [["name", "test:package"], ["repository_id", 75], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------------------------
PackageTest: test_: associations should have many versions dependent => destroy. 
---------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------------
PackageTest: test_: associations should belong to repository required: true. 
-----------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mPackage Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "packages" WHERE "packages"."name" IS NULL AND "packages"."repository_id" IS NULL LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------
PackageTest: test_: scopes should return recently updated packages. 
--------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "test-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.3ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "test-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 17:01:07.044362"], ["updated_at", "2025-10-31 17:01:07.044362"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPackage Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "packages" WHERE "packages"."name" = $1 AND "packages"."repository_id" = $2 LIMIT $3[0m  [["name", "recent:package"], ["repository_id", 76], ["LIMIT", 1]]
  [1m[36mPackage Create (1.5ms)[0m  [1m[32mINSERT INTO "packages" ("repository_id", "name", "group_id", "artifact_id", "last_modified", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["repository_id", 76], ["name", "recent:package"], ["group_id", "recent"], ["artifact_id", "package"], ["last_modified", "2025-10-30 17:01:07.046045"], ["metadata", "{}"], ["created_at", "2025-10-31 17:01:07.047419"], ["updated_at", "2025-10-31 17:01:07.047419"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPackage Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "packages" WHERE "packages"."name" = $1 AND "packages"."repository_id" = $2 LIMIT $3[0m  [["name", "old:package"], ["repository_id", 76], ["LIMIT", 1]]
  [1m[36mPackage Create (1.0ms)[0m  [1m[32mINSERT INTO "packages" ("repository_id", "name", "group_id", "artifact_id", "last_modified", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["repository_id", 76], ["name", "old:package"], ["group_id", "old"], ["artifact_id", "package"], ["last_modified", "2025-10-17 17:01:07.052146"], ["metadata", "{}"], ["created_at", "2025-10-31 17:01:07.052808"], ["updated_at", "2025-10-31 17:01:07.052808"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mPackage Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "packages" WHERE (last_modified >= $1) AND "packages"."id" = $2 LIMIT $3[0m  [[nil, "2025-10-24 17:01:07.054749"], ["id", 13], ["LIMIT", 1]]
  [1m[36mPackage Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "packages" WHERE (last_modified >= $1) AND "packages"."id" = $2 LIMIT $3[0m  [[nil, "2025-10-24 17:01:07.056226"], ["id", 14], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------------------------
PackageTest: test_: validations should validate that :group_id cannot be empty/falsy. 
--------------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "test-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.2ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "test-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 17:01:07.058967"], ["updated_at", "2025-10-31 17:01:07.058967"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mPackage Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "packages" WHERE "packages"."name" = $1 AND "packages"."repository_id" = $2 LIMIT $3[0m  [["name", "test:package"], ["repository_id", 77], ["LIMIT", 1]]
  [1m[36mCACHE Package Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "packages" WHERE "packages"."name" = $1 AND "packages"."repository_id" = $2 LIMIT $3[0m  [["name", "test:package"], ["repository_id", 77], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------------------------------------------
PackageTest: test_: #set_name_from_parts should automatically set name from group_id and artifact_id. 
------------------------------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "test-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.2ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "test-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 17:01:07.069457"], ["updated_at", "2025-10-31 17:01:07.069457"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mPackage Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "packages" WHERE "packages"."name" = $1 AND "packages"."repository_id" = $2 LIMIT $3[0m  [["name", "org.example:test-lib"], ["repository_id", 78], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------------------------------------------------
Api::V1::RepositoriesControllerTest: test_: GET /api/v1/repositories/:name/packages should return package names. 
-----------------------------------------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "test-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.3ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "test-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 17:01:07.072865"], ["updated_at", "2025-10-31 17:01:07.072865"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPackage Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "packages" WHERE "packages"."name" = $1 AND "packages"."repository_id" = $2 LIMIT $3[0m  [["name", "org.example:lib1"], ["repository_id", 79], ["LIMIT", 1]]
  [1m[36mPackage Create (0.5ms)[0m  [1m[32mINSERT INTO "packages" ("repository_id", "name", "group_id", "artifact_id", "last_modified", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["repository_id", 79], ["name", "org.example:lib1"], ["group_id", "org.example"], ["artifact_id", "lib1"], ["last_modified", nil], ["metadata", "{}"], ["created_at", "2025-10-31 17:01:07.075112"], ["updated_at", "2025-10-31 17:01:07.075112"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPackage Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "packages" WHERE "packages"."name" = $1 AND "packages"."repository_id" = $2 LIMIT $3[0m  [["name", "org.example:lib2"], ["repository_id", 79], ["LIMIT", 1]]
  [1m[36mPackage Create (0.3ms)[0m  [1m[32mINSERT INTO "packages" ("repository_id", "name", "group_id", "artifact_id", "last_modified", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["repository_id", 79], ["name", "org.example:lib2"], ["group_id", "org.example"], ["artifact_id", "lib2"], ["last_modified", nil], ["metadata", "{}"], ["created_at", "2025-10-31 17:01:07.076550"], ["updated_at", "2025-10-31 17:01:07.076550"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/api/v1/repositories/test-repo/packages" for 127.0.0.1 at 2025-10-31 17:01:07 +0000
Processing by Api::V1::RepositoriesController#packages as JSON
  Parameters: {"name" => "test-repo"}
  [1m[36mRepository Load (1.8ms)[0m  [1m[34mSELECT "repositories".* FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "test-repo"], ["LIMIT", 1]]
  [1m[36mPackage Pluck (0.8ms)[0m  [1m[34mSELECT "packages"."name" FROM "packages" WHERE "packages"."repository_id" = $1[0m  [["repository_id", 79]]
Completed 200 OK in 34ms (Views: 0.2ms | ActiveRecord: 2.6ms (2 queries, 0 cached) | GC: 11.9ms)
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------------------------------------------------------------
Api::V1::RepositoriesControllerTest: test_: GET /api/v1/repositories/:name should return repository details. 
-------------------------------------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (1.9ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (2.6ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "test-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.3ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "test-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 17:01:07.168581"], ["updated_at", "2025-10-31 17:01:07.168581"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/api/v1/repositories/test-repo" for 127.0.0.1 at 2025-10-31 17:01:07 +0000
Processing by Api::V1::RepositoriesController#show as JSON
  Parameters: {"name" => "test-repo"}
  [1m[36mRepository Load (0.4ms)[0m  [1m[34mSELECT "repositories".* FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "test-repo"], ["LIMIT", 1]]
Completed 200 OK in 2ms (Views: 0.1ms | ActiveRecord: 0.4ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------------------------------------------
Api::V1::RepositoriesControllerTest: test_: POST /api/v1/sync_repositories should create new repositories. 
-----------------------------------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
Started POST "/api/v1/sync_repositories" for 127.0.0.1 at 2025-10-31 17:01:07 +0000
Processing by Api::V1::RepositoriesController#sync as JSON
  Parameters: {"_json" => [{"name" => "new-repo", "url" => "http://example.com/new", "ecosystem" => "maven"}], "repository" => {}}
  [1m[36mRepository Load (0.5ms)[0m  [1m[34mSELECT "repositories".* FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "new-repo"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "new-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.4ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "new-repo"], ["url", "http://example.com/new"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 17:01:07.176399"], ["updated_at", "2025-10-31 17:01:07.176399"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 2ms (Views: 0.1ms | ActiveRecord: 1.5ms (3 queries, 0 cached) | GC: 0.0ms)
  [1m[36mRepository Load (0.2ms)[0m  [1m[34mSELECT "repositories".* FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "new-repo"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------------------------------------
Api::V1::RepositoriesControllerTest: test_: GET /api/v1/repositories should return all repositories. 
-----------------------------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "repo1"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.9ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "repo1"], ["url", "http://example.com/repo1"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 17:01:07.181425"], ["updated_at", "2025-10-31 17:01:07.181425"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "repo2"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.4ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "repo2"], ["url", "http://example.com/repo2"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 17:01:07.185753"], ["updated_at", "2025-10-31 17:01:07.185753"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/api/v1/repositories" for 127.0.0.1 at 2025-10-31 17:01:07 +0000
Processing by Api::V1::RepositoriesController#index as JSON
  [1m[36mRepository Load (1.0ms)[0m  [1m[34mSELECT "repositories".* FROM "repositories" ORDER BY "repositories"."name" ASC[0m
Completed 200 OK in 2ms (Views: 0.0ms | ActiveRecord: 1.0ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------
MavenIndexParserTest: test_: #parse should parse .fld file correctly. 
----------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mActiveRecord::InternalMetadata Load (2.6ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (2.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------
HomeControllerTest: test_should_get_index_with_API_information
--------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
Started GET "/" for 127.0.0.1 at 2025-10-31 17:03:40 +0000
Processing by HomeController#index as HTML
Completed 200 OK in 3ms (Views: 0.1ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------
HomeControllerTest: test_should_return_JSON_format
--------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
Started GET "/" for 127.0.0.1 at 2025-10-31 17:03:40 +0000
Processing by HomeController#index as HTML
Completed 200 OK in 0ms (Views: 0.1ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mActiveRecord::InternalMetadata Load (3.5ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (2.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------------------------------
RepositoryTest: test_: validations should validate that :name is case-sensitively unique. 
------------------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mRepository Load (2.1ms)[0m  [1m[34mSELECT "repositories".* FROM "repositories" ORDER BY "repositories"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Create (0.7ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "test-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 17:03:46.713723"], ["updated_at", "2025-10-31 17:03:46.713723"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "test-repo"], ["LIMIT", 1]]
  [1m[36mRepository Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "TEST-REPO"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------------------------
RepositoryTest: test_: associations should have many packages dependent => destroy. 
------------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------------------
RepositoryTest: test_: status management should mark as completed. 
-------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "test-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.4ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "test-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 17:03:46.733547"], ["updated_at", "2025-10-31 17:03:46.733547"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Update (0.7ms)[0m  [1m[33mUPDATE "repositories" SET "last_indexed_at" = $1, "status" = $2, "package_count" = $3, "index_size_bytes" = $4, "updated_at" = $5 WHERE "repositories"."id" = $6[0m  [["last_indexed_at", "2025-10-31 17:03:46.734537"], ["status", "completed"], ["package_count", 100], ["index_size_bytes", 1000], ["updated_at", "2025-10-31 17:03:46.743080"], ["id", 85]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------------------------------------------
RepositoryTest: test_: #needs_reindex? should return true if last indexed beyond interval. 
-------------------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------------------
RepositoryTest: test_: #needs_reindex? should return false if recently indexed. 
--------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------
RepositoryTest: test_: scopes should return pending repositories. 
------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "pending-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.3ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "pending-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 17:03:46.749073"], ["updated_at", "2025-10-31 17:03:46.749073"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "indexing-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.5ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "indexing-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "indexing"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 17:03:46.757110"], ["updated_at", "2025-10-31 17:03:46.757110"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "completed-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.2ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "completed-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", "2025-10-31 16:03:46.758399"], ["status", "completed"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 17:03:46.759351"], ["updated_at", "2025-10-31 17:03:46.759351"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "failed-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.3ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "failed-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "failed"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 17:03:46.765657"], ["updated_at", "2025-10-31 17:03:46.765657"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."status" = $1 AND "repositories"."id" = $2 LIMIT $3[0m  [["status", "pending"], ["id", 86], ["LIMIT", 1]]
  [1m[36mRepository Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."status" = $1 AND "repositories"."id" = $2 LIMIT $3[0m  [["status", "pending"], ["id", 88], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------
RepositoryTest: test_: status management should mark as failed. 
----------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "test-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.3ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "test-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 17:03:46.770494"], ["updated_at", "2025-10-31 17:03:46.770494"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Update (0.8ms)[0m  [1m[33mUPDATE "repositories" SET "status" = $1, "error_message" = $2, "updated_at" = $3 WHERE "repositories"."id" = $4[0m  [["status", "failed"], ["error_message", "Test error"], ["updated_at", "2025-10-31 17:03:46.771364"], ["id", 90]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------
RepositoryTest: test_: #index_url should return the correct index URL. 
-----------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------------------------
RepositoryTest: test_: validations should validate that :url cannot be empty/falsy. 
------------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mRepository Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "test-repo"], ["LIMIT", 1]]
  [1m[36mCACHE Repository Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "test-repo"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------------------------------------
RepositoryTest: test_: validations should validate that :name cannot be empty/falsy. 
-------------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mRepository Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", ""], ["LIMIT", 1]]
  [1m[36mRepository Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" IS NULL LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------------
RepositoryTest: test_: #needs_reindex? should return true if never indexed. 
----------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------
RepositoryTest: test_: scopes should return completed repositories. 
--------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "pending-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.5ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "pending-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 17:03:46.797571"], ["updated_at", "2025-10-31 17:03:46.797571"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (1.9ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "indexing-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.3ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "indexing-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "indexing"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 17:03:46.812809"], ["updated_at", "2025-10-31 17:03:46.812809"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (1.1ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "completed-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.3ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "completed-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", "2025-10-31 16:03:46.813963"], ["status", "completed"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 17:03:46.820871"], ["updated_at", "2025-10-31 17:03:46.820871"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "failed-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.5ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "failed-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "failed"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 17:03:46.823094"], ["updated_at", "2025-10-31 17:03:46.823094"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."status" = $1 AND "repositories"."id" = $2 LIMIT $3[0m  [["status", "completed"], ["id", 93], ["LIMIT", 1]]
  [1m[36mRepository Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."status" = $1 AND "repositories"."id" = $2 LIMIT $3[0m  [["status", "completed"], ["id", 91], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------
RepositoryTest: test_: status management should mark as indexing. 
------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (1.6ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "test-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.3ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "test-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 17:03:46.830416"], ["updated_at", "2025-10-31 17:03:46.830416"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Update (1.2ms)[0m  [1m[33mUPDATE "repositories" SET "status" = $1, "updated_at" = $2 WHERE "repositories"."id" = $3[0m  [["status", "indexing"], ["updated_at", "2025-10-31 17:03:46.833168"], ["id", 95]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------
HomeControllerTest: test_should_get_index_with_API_information
--------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
Started GET "/" for 127.0.0.1 at 2025-10-31 17:03:46 +0000
Processing by HomeController#index as HTML
Completed 200 OK in 4ms (Views: 0.1ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------
HomeControllerTest: test_should_return_JSON_format
--------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
Started GET "/" for 127.0.0.1 at 2025-10-31 17:03:46 +0000
Processing by HomeController#index as HTML
Completed 200 OK in 0ms (Views: 0.1ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------------------------
PackageTest: test_: associations should have many versions dependent => destroy. 
---------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------------------------
PackageTest: test_: validations should validate that :group_id cannot be empty/falsy. 
--------------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "test-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.4ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "test-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 17:03:46.910181"], ["updated_at", "2025-10-31 17:03:46.910181"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mPackage Exists? (1.8ms)[0m  [1m[34mSELECT 1 AS one FROM "packages" WHERE "packages"."name" = $1 AND "packages"."repository_id" = $2 LIMIT $3[0m  [["name", "test:package"], ["repository_id", 96], ["LIMIT", 1]]
  [1m[36mCACHE Package Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "packages" WHERE "packages"."name" = $1 AND "packages"."repository_id" = $2 LIMIT $3[0m  [["name", "test:package"], ["repository_id", 96], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------------------------------------------
PackageTest: test_: #set_name_from_parts should automatically set name from group_id and artifact_id. 
------------------------------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "test-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.5ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "test-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 17:03:46.924667"], ["updated_at", "2025-10-31 17:03:46.924667"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mPackage Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "packages" WHERE "packages"."name" = $1 AND "packages"."repository_id" = $2 LIMIT $3[0m  [["name", "org.example:test-lib"], ["repository_id", 97], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------------------------
PackageTest: test_: validations should validate that :artifact_id cannot be empty/falsy. 
-----------------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "test-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.3ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "test-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 17:03:46.929385"], ["updated_at", "2025-10-31 17:03:46.929385"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mPackage Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "packages" WHERE "packages"."name" = $1 AND "packages"."repository_id" = $2 LIMIT $3[0m  [["name", "test:package"], ["repository_id", 98], ["LIMIT", 1]]
  [1m[36mCACHE Package Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "packages" WHERE "packages"."name" = $1 AND "packages"."repository_id" = $2 LIMIT $3[0m  [["name", "test:package"], ["repository_id", 98], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------
PackageTest: test_: scopes should return recently updated packages. 
--------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "test-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.3ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "test-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 17:03:46.936104"], ["updated_at", "2025-10-31 17:03:46.936104"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPackage Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "packages" WHERE "packages"."name" = $1 AND "packages"."repository_id" = $2 LIMIT $3[0m  [["name", "recent:package"], ["repository_id", 99], ["LIMIT", 1]]
  [1m[36mPackage Create (0.9ms)[0m  [1m[32mINSERT INTO "packages" ("repository_id", "name", "group_id", "artifact_id", "last_modified", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["repository_id", 99], ["name", "recent:package"], ["group_id", "recent"], ["artifact_id", "package"], ["last_modified", "2025-10-30 17:03:46.936879"], ["metadata", "{}"], ["created_at", "2025-10-31 17:03:46.940688"], ["updated_at", "2025-10-31 17:03:46.940688"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPackage Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "packages" WHERE "packages"."name" = $1 AND "packages"."repository_id" = $2 LIMIT $3[0m  [["name", "old:package"], ["repository_id", 99], ["LIMIT", 1]]
  [1m[36mPackage Create (0.4ms)[0m  [1m[32mINSERT INTO "packages" ("repository_id", "name", "group_id", "artifact_id", "last_modified", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["repository_id", 99], ["name", "old:package"], ["group_id", "old"], ["artifact_id", "package"], ["last_modified", "2025-10-17 17:03:46.943721"], ["metadata", "{}"], ["created_at", "2025-10-31 17:03:46.944312"], ["updated_at", "2025-10-31 17:03:46.944312"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mPackage Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "packages" WHERE (last_modified >= $1) AND "packages"."id" = $2 LIMIT $3[0m  [[nil, "2025-10-24 17:03:46.945304"], ["id", 17], ["LIMIT", 1]]
  [1m[36mPackage Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "packages" WHERE (last_modified >= $1) AND "packages"."id" = $2 LIMIT $3[0m  [[nil, "2025-10-24 17:03:46.946916"], ["id", 18], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------------
PackageTest: test_: associations should belong to repository required: true. 
-----------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mPackage Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "packages" WHERE "packages"."name" IS NULL AND "packages"."repository_id" IS NULL LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (2.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------------------------------------
Api::V1::RepositoriesControllerTest: test_: GET /api/v1/repositories should return all repositories. 
-----------------------------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "repo1"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.3ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "repo1"], ["url", "http://example.com/repo1"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 17:03:46.953996"], ["updated_at", "2025-10-31 17:03:46.953996"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "repo2"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.5ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "repo2"], ["url", "http://example.com/repo2"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 17:03:46.955158"], ["updated_at", "2025-10-31 17:03:46.955158"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/api/v1/repositories" for 127.0.0.1 at 2025-10-31 17:03:46 +0000
Processing by Api::V1::RepositoriesController#index as JSON
  [1m[36mRepository Load (0.5ms)[0m  [1m[34mSELECT "repositories".* FROM "repositories" ORDER BY "repositories"."name" ASC[0m
Completed 200 OK in 8ms (Views: 0.1ms | ActiveRecord: 0.5ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------------------------------------------------
Api::V1::RepositoriesControllerTest: test_: GET /api/v1/repositories/:name/packages should return package names. 
-----------------------------------------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "test-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.4ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "test-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 17:03:46.967814"], ["updated_at", "2025-10-31 17:03:46.967814"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPackage Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "packages" WHERE "packages"."name" = $1 AND "packages"."repository_id" = $2 LIMIT $3[0m  [["name", "org.example:lib1"], ["repository_id", 102], ["LIMIT", 1]]
  [1m[36mPackage Create (0.5ms)[0m  [1m[32mINSERT INTO "packages" ("repository_id", "name", "group_id", "artifact_id", "last_modified", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["repository_id", 102], ["name", "org.example:lib1"], ["group_id", "org.example"], ["artifact_id", "lib1"], ["last_modified", nil], ["metadata", "{}"], ["created_at", "2025-10-31 17:03:46.969588"], ["updated_at", "2025-10-31 17:03:46.969588"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPackage Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "packages" WHERE "packages"."name" = $1 AND "packages"."repository_id" = $2 LIMIT $3[0m  [["name", "org.example:lib2"], ["repository_id", 102], ["LIMIT", 1]]
  [1m[36mPackage Create (0.4ms)[0m  [1m[32mINSERT INTO "packages" ("repository_id", "name", "group_id", "artifact_id", "last_modified", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["repository_id", 102], ["name", "org.example:lib2"], ["group_id", "org.example"], ["artifact_id", "lib2"], ["last_modified", nil], ["metadata", "{}"], ["created_at", "2025-10-31 17:03:46.971007"], ["updated_at", "2025-10-31 17:03:46.971007"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/api/v1/repositories/test-repo/packages" for 127.0.0.1 at 2025-10-31 17:03:46 +0000
Processing by Api::V1::RepositoriesController#packages as JSON
  Parameters: {"name" => "test-repo"}
  [1m[36mRepository Load (0.8ms)[0m  [1m[34mSELECT "repositories".* FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "test-repo"], ["LIMIT", 1]]
  [1m[36mPackage Pluck (0.3ms)[0m  [1m[34mSELECT "packages"."name" FROM "packages" WHERE "packages"."repository_id" = $1[0m  [["repository_id", 102]]
Completed 200 OK in 8ms (Views: 0.0ms | ActiveRecord: 1.2ms (2 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------------------------------------------
Api::V1::RepositoriesControllerTest: test_: POST /api/v1/sync_repositories should create new repositories. 
-----------------------------------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
Started POST "/api/v1/sync_repositories" for 127.0.0.1 at 2025-10-31 17:03:46 +0000
Processing by Api::V1::RepositoriesController#sync as JSON
  Parameters: {"_json" => [{"name" => "new-repo", "url" => "http://example.com/new", "ecosystem" => "maven"}], "repository" => {}}
  [1m[36mRepository Load (0.3ms)[0m  [1m[34mSELECT "repositories".* FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "new-repo"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "new-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.3ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "new-repo"], ["url", "http://example.com/new"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 17:03:46.985807"], ["updated_at", "2025-10-31 17:03:46.985807"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 2ms (Views: 0.0ms | ActiveRecord: 1.0ms (3 queries, 0 cached) | GC: 0.0ms)
  [1m[36mRepository Load (0.2ms)[0m  [1m[34mSELECT "repositories".* FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "new-repo"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------------------------------------------------------------
Api::V1::RepositoriesControllerTest: test_: GET /api/v1/repositories/:name should return repository details. 
-------------------------------------------------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRepository Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "test-repo"], ["LIMIT", 1]]
  [1m[36mRepository Create (0.2ms)[0m  [1m[32mINSERT INTO "repositories" ("name", "url", "ecosystem", "last_indexed_at", "status", "error_message", "package_count", "index_size_bytes", "metadata", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "test-repo"], ["url", "http://example.com"], ["ecosystem", "maven"], ["last_indexed_at", nil], ["status", "pending"], ["error_message", nil], ["package_count", 0], ["index_size_bytes", nil], ["metadata", "{}"], ["created_at", "2025-10-31 17:03:46.991620"], ["updated_at", "2025-10-31 17:03:46.991620"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/api/v1/repositories/test-repo" for 127.0.0.1 at 2025-10-31 17:03:46 +0000
Processing by Api::V1::RepositoriesController#show as JSON
  Parameters: {"name" => "test-repo"}
  [1m[36mRepository Load (0.1ms)[0m  [1m[34mSELECT "repositories".* FROM "repositories" WHERE "repositories"."name" = $1 LIMIT $2[0m  [["name", "test-repo"], ["LIMIT", 1]]
Completed 200 OK in 1ms (Views: 0.0ms | ActiveRecord: 0.1ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------
MavenIndexParserTest: test_: #parse should parse .fld file correctly. 
----------------------------------------------------------------------
[dotenv] Saved a snapshot of [32mENV[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
